(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0e73"],{"/cmk":function(e,t,r){"use strict";r.r(t);var a=r("QbLZ"),n=r.n(a),s=r("14Xm"),i=r.n(s),o=r("D3Ub"),l=r.n(o),u=r("PoRY"),c=r("SiVN"),d=r("fVKT"),p=r("hwwj"),m=(r("sJ1T"),r("aMx7")),f=r("P7iO"),h={name:"StudentForm",components:{Markdown:m.a,AsyncSelect:f.a},mixins:[d.a,p.a],data:function(){var e=this;return{form:{name:"",email:"",phone:"",description:"",specializationsIds:[],universitiesIds:[{}],isAvailable:!0,user:{email:"",password:""}},show:!1,isEdit:!1,rules:{name:[{required:!0,message:"Введите название компании",trigger:"blur"}],user:[{validator:function(t,r,a){""!==r.email&&e.validateEmail(r.email)||a(new Error("Введите email владельца компании")),""!==r.password||e.isEdit&&!e.isNewPassword||a(new Error("Введите пароль владельца компании")),r.password&&r.password.length<4&&(!e.isEdit||e.isNewPassword)&&a(new Error("Пароль должен быть минимум из 4 символов")),a()},trigger:"blur"},{required:!0,trigger:"blur"}]},isNewPassword:!1}},computed:{maskedPhone:{get:function(){return new u.a("RU").input(this.form.phone)},set:function(e){var t=Object(c.a)(e);2===e.length&&"+7"!==e.substring(0,2)?this.form.phone="+7":1===e.length&&"+"!==e.substring(0,1)?this.form.phone="+7"+e:t.length>13?this.form.phone=t.substring(0,12):this.form.phone=t}}},mounted:function(){this.$route.params.id&&(this.isEdit=!0,this.fetchData())},methods:{fetchData:function(){var e=this;return l()(i.a.mark(function t(){var r,a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$apiClient.service("students"),t.next=3,r.get(e.$route.params.id);case 3:(a=t.sent).user||(a.user={email:"",password:""}),a.universitiesIds&&0!==a.universitiesIds.length||(a.universitiesIds=[{}]),e.form=a;case 7:case"end":return t.stop()}},t,e)}))()},onEdit:function(){var e=this;return l()(i.a.mark(function t(){var r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.validateForm("ruleForm");case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",!1);case 8:return t.prev=8,t.next=11,e.confirmUpdate("Сохранить изменения компании?","Компания не изменена");case 11:t.next=16;break;case 13:return t.prev=13,t.t1=t.catch(8),t.abrupt("return",!1);case 16:return r=e.$apiClient.service("students"),t.prev=17,t.next=20,r.patch(e.$route.params.id,n()({},e.form));case 20:t.next=26;break;case 22:return t.prev=22,t.t2=t.catch(17),e.$message({message:t.t2.message,type:"error"}),t.abrupt("return",!1);case 26:e.$message({message:"Компания изменена!",type:"success"}),e.$router.push({name:"Students"});case 28:case"end":return t.stop()}},t,e,[[0,5],[8,13],[17,22]])}))()},onAdd:function(){var e=this;return l()(i.a.mark(function t(){var r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.validateForm("ruleForm");case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",!1);case 8:return r=e.$apiClient.service("students"),t.prev=9,t.next=12,r.create(n()({},e.form));case 12:t.next=18;break;case 14:return t.prev=14,t.t1=t.catch(9),e.$message({message:t.t1.message,type:"error"}),t.abrupt("return",!1);case 18:e.$message({message:"Компания сохранена!",type:"success"}),e.$router.push({name:"Students"});case 20:case"end":return t.stop()}},t,e,[[0,5],[9,14]])}))()},onCancel:function(){var e=this;return l()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.confirmUpdate("Оменить изменения компании?","Продолжайте редактирование компании");case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",!1);case 8:e.$message({message:"Компания не изменена!",type:"warning"}),e.$router.push({name:"Students"});case 10:case"end":return t.stop()}},t,e,[[0,5]])}))()},handleImageDataUrl:function(e){this.imageUrl=e},toggleShow:function(){this.show=!this.show},generatePassword:function(){this.form.user.password=""+Math.floor(1e5*Math.random())},changePassword:function(){this.isNewPassword=!0,this.$set(this.form.user,"password",null)},validateEmail:function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},setUniversity:function(e,t,r){this.form.universitiesIds[r][e]=t}}},v=(r("4Ffl"),r("KHd+")),w=Object(v.a)(h,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.form,"label-width":"160px"}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{prop:"firstName",label:"Имя"}},[r("el-input",{model:{value:e.form.firstName,callback:function(t){e.$set(e.form,"firstName",t)},expression:"form.firstName"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{prop:"lastName",label:"Фамилия"}},[r("el-input",{model:{value:e.form.lastName,callback:function(t){e.$set(e.form,"lastName",t)},expression:"form.lastName"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"E-mail"}},[r("el-input",{attrs:{name:"copanyName"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"Номер телефона"}},[r("el-input",{attrs:{placeholder:"+7 999 999-99-99"},model:{value:e.maskedPhone,callback:function(t){e.maskedPhone=t},expression:"maskedPhone"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{prop:"cityId",label:"Город"}},[r("AsyncSelect",{attrs:{service:"cities",label:"name",value:e.form.cityId,multiple:!1},on:{"value-changed":function(t){return e.form.cityId=t}}})],1)],1)],1),e._v(" "),r("h1",[e._v("Образование студента")]),e._v(" "),e._l(e.form.universitiesIds,function(t,a){return r("div",{key:a},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{prop:"universityId",label:"Университет"}},[r("AsyncSelect",{attrs:{service:"cities",label:"name",value:t.universityId,multiple:!1},on:{"value-changed":function(t){return e.setUniversity("universityId",t,a)}}})],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{prop:"specializationId",label:"Специализация"}},[r("AsyncSelect",{attrs:{service:"specializations",label:"name",value:t.specializationId,multiple:!0},on:{"value-changed":function(t){return e.setUniversity("specializationId",t,a)}}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{prop:"universityId",label:"Дата поступления"}},[r("el-date-picker",{attrs:{type:"date",format:"yyyy",placeholder:"Выберите дату"},model:{value:t.enterDate,callback:function(r){e.$set(t,"enterDate",r)},expression:"university.enterDate"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{prop:"universityId",label:"Дата окончания"}},[r("el-date-picker",{attrs:{type:"date",format:"yyyy",placeholder:"Выберите дату"},model:{value:t.endDate,callback:function(r){e.$set(t,"endDate",r)},expression:"university.endDate"}})],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"Описание"}},[r("Markdown",{attrs:{input:t.description},on:{"on-update":function(t){return e.setUniversity("description",t,a)}}})],1)],1)}),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(){return e.form.universitiesIds.push({})}}},[e._v("\n      Добавить университет\n    ")]),e._v(" "),r("el-form-item",{attrs:{label:"Образование"}},[r("Markdown",{attrs:{input:e.form.education},on:{"on-update":function(t){return e.form.education=t}}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Опыт работы"}},[r("Markdown",{attrs:{input:e.form.job},on:{"on-update":function(t){return e.form.job=t}}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Дополнительные скилы"}},[r("Markdown",{attrs:{input:e.form.additionalSkills},on:{"on-update":function(t){return e.form.additionalSkills=t}}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Личные навыки"}},[r("Markdown",{attrs:{input:e.form.personalQualities},on:{"on-update":function(t){return e.form.personalQualities=t}}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Достижения"}},[r("Markdown",{attrs:{input:e.form.achievements},on:{"on-update":function(t){return e.form.achievements=t}}})],1),e._v(" "),e.isEdit?e._e():r("el-form-item",{attrs:{prop:"user",label:"Пользователь"}},[r("el-col",{attrs:{span:7}},[r("el-input",{attrs:{placeholder:"Email пользователя"},model:{value:e.form.user.email,callback:function(t){e.$set(e.form.user,"email",t)},expression:"form.user.email"}})],1),e._v(" "),!e.isEdit||e.isNewPassword?r("el-col",{attrs:{span:7,offset:1}},[r("el-input",{attrs:{placeholder:"Пароль"},model:{value:e.form.user.password,callback:function(t){e.$set(e.form.user,"password",t)},expression:"form.user.password"}})],1):e._e(),e._v(" "),!e.isEdit||e.isNewPassword?r("el-col",{attrs:{span:2,offset:1}},[r("el-button",{attrs:{type:"primary"},on:{click:e.generatePassword}},[e._v("\n          Сгенерировать\n        ")])],1):e._e(),e._v(" "),e.isEdit&&!e.isNewPassword?r("el-col",{attrs:{span:7,offset:1}},[r("el-button",{attrs:{type:"primary"},on:{click:e.changePassword}},[e._v("\n          Изменить пароль\n        ")])],1):e._e()],1),e._v(" "),r("el-form-item",[e.isEdit?r("el-button",{attrs:{type:"primary"},on:{click:e.onEdit}},[e._v("\n        Изменить\n      ")]):e._e(),e._v(" "),e.isEdit?e._e():r("el-button",{attrs:{type:"primary"},on:{click:e.onAdd}},[e._v("\n        Cохранить\n      ")]),e._v(" "),r("el-button",{on:{click:e.onCancel}},[e._v("Отмена")])],1)],2)],1)},[],!1,null,null,null);w.options.__file="StudentForm.vue";t.default=w.exports},"/r2A":function(e,t,r){},"4Ffl":function(e,t,r){"use strict";var a=r("SelP");r.n(a).a},Et1E:function(e,t,r){"use strict";var a=r("/r2A");r.n(a).a},P7iO:function(e,t,r){"use strict";var a=r("14Xm"),n=r.n(a),s=r("D3Ub"),i=r.n(s),o={name:"AddressSelect",props:{service:{type:String,required:!0},label:{type:String,required:!0},placeholder:{type:String,default:""},value:{type:Array|Number,default:function(){return[]}},bind:{type:Object,default:function(){return{}}}},data:function(){return{address:{},addresses:[],addressSearch:""}},watch:{value:{handler:function(e){this.address=e},deep:!0,immediate:!0}},methods:{fetchAddresses:function(){var e=this;return i()(n.a.mark(function t(){var r,a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={$limit:-1},e.addressSearch&&(r.$search=e.addressSearch),t.next=4,e.$apiClient.service(e.service).find({query:r});case 4:a=t.sent,Array.isArray(a)?e.addresses=a:e.addresses=a.data;case 6:case"end":return t.stop()}},t,e)}))()},resetAddresses:function(e){this.addressSearch=e,this.addresses=[],this.fetchAddresses()},addressChanged:function(e){this.address=e,this.$emit("value-changed",this.address)}}},l=(r("Et1E"),r("KHd+")),u=Object(l.a)(o,function(){var e=this,t=e.$createElement;return(e._self._c||t)("v-select",e._b({attrs:{value:e.address,label:e.label,reduce:function(e){return e.id},options:e.addresses,fetchData:e.fetchAddresses,taggable:!1,clearable:!1,"infinite-loading":!1,placeholder:e.placeholder},on:{search:e.resetAddresses,input:e.addressChanged}},"v-select",e.bind,!1))},[],!1,null,null,null);u.options.__file="index.vue";t.a=u.exports},SelP:function(e,t,r){},aMx7:function(e,t,r){"use strict";var a=r("LvDl"),n=r.n(a),s=r("DlQD"),i=r.n(s),o={name:"Markdown",props:{input:{type:String,default:""}},computed:{compiledMarkdown:function(){return i()(this.input,{sanitize:!0})}},methods:{update:n.a.debounce(function(e){this.$emit("on-update",e.target.value)},200)}},l=(r("nPYF"),r("KHd+")),u=Object(l.a)(o,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"editor"},[t("textarea",{domProps:{value:this.input},on:{input:this.update}}),this._v(" "),t("div",{domProps:{innerHTML:this._s(this.compiledMarkdown)}})])},[],!1,null,"7dce4b95",null);u.options.__file="index.vue";t.a=u.exports},fVKT:function(e,t,r){"use strict";var a=r("4d7F"),n=r.n(a);t.a={methods:{validateForm:function(e){var t=this;return new n.a(function(r,a){t.$refs[e].validate(function(e){e?r(e):(t.$message({message:"Данные заполнены неверно",type:"error"}),a(e))})})}}}},hNOc:function(e,t,r){},hwwj:function(e,t,r){"use strict";var a=r("14Xm"),n=r.n(a),s=r("D3Ub"),i=r.n(s);t.a={methods:{confirmUpdate:function(e,t){var r=this;return i()(n.a.mark(function a(){return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,r.$confirm(e,"Предупреждение",{confirmButtonText:"Да",cancelButtonText:"Нет",type:"warning"});case 3:a.next=9;break;case 5:throw a.prev=5,a.t0=a.catch(0),r.$message({message:t}),new Error(a.t0);case 9:case"end":return a.stop()}},a,r,[[0,5]])}))()}}}},nPYF:function(e,t,r){"use strict";var a=r("hNOc");r.n(a).a},sJ1T:function(e,t,r){"use strict";var a=r("QbLZ"),n=r.n(a),s=r("L2JU"),i={name:"CropUpload",components:{cropUpload:r("C03Y").a},props:{show:{type:Boolean,default:!1}},data:function(){return{fileUrl:"https://skfu.spichka.dev/api/v1/files/",componentShow:!1}},computed:n()({},Object(s.c)({token:"user/token"}),{headerInfo:function(){return{Authorization:"Bearer "+this.token}}}),watch:{show:function(){this.componentShow=this.show}},methods:{handleImageDataUrl:function(e){this.$emit("update-image-url",e)},handleAvatarSuccess:function(e){this.$emit("image-loaded",e)}}},o=r("KHd+"),l=Object(o.a)(i,function(){var e=this,t=e.$createElement;return(e._self._c||t)("crop-upload",{attrs:{width:800,height:600,url:e.fileUrl,headers:e.headerInfo,"lang-type":"ru",field:"file","img-format":"png"},on:{"crop-success":e.handleImageDataUrl,"crop-upload-success":e.handleAvatarSuccess},model:{value:e.componentShow,callback:function(t){e.componentShow=t},expression:"componentShow"}})},[],!1,null,null,null);l.options.__file="index.vue";t.a=l.exports}}]);